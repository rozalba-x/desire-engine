<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desire Engine - Catch Your Hidden Wants</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #7c2d12, #991b1b, #7c2856);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 4rem;
            font-weight: 900;
            letter-spacing: -0.02em;
            margin-bottom: 1rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.25rem;
            color: #fca5a5;
            max-width: 600px;
            margin: 0 auto 1rem;
            line-height: 1.6;
        }

        .pulse-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status {
            color: #86efac;
            font-size: 0.875rem;
            margin-top: 1rem;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .card {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 1rem;
            padding: 2rem;
        }

        .card-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .card-text {
            color: #fca5a5;
            line-height: 1.6;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 1rem;
            padding: 1.5rem;
            text-align: center;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 900;
            color: #ef4444;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #fca5a5;
        }

        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            margin: 3rem 0;
        }

        .btn {
            background: linear-gradient(135deg, #dc2626, #7c2d12);
            color: white;
            padding: 1rem 2rem;
            border: none;
            border-radius: 1rem;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: scale(1.05);
            background: linear-gradient(135deg, #ef4444, #991b1b);
        }

        .btn-purple {
            background: linear-gradient(135deg, #7c3aed, #5b21b6);
        }

        .btn-purple:hover {
            background: linear-gradient(135deg, #8b5cf6, #6d28d9);
        }

        .btn-yellow {
            background: linear-gradient(135deg, #d97706, #92400e);
        }

        .btn-yellow:hover {
            background: linear-gradient(135deg, #f59e0b, #b45309);
        }

        .quote-box {
            text-align: center;
            margin: 3rem 0;
            padding: 2rem;
            border: 2px solid rgba(239, 68, 68, 0.3);
            border-radius: 1rem;
            background: rgba(0, 0, 0, 0.1);
        }

        .quote-text {
            font-size: 1.125rem;
            font-weight: 500;
            color: #fca5a5;
            font-style: italic;
        }

        .form-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .form-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 1rem;
        }

        .form-subtitle {
            text-align: center;
            color: #fca5a5;
            margin-bottom: 2rem;
        }

        .categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .category-btn {
            padding: 1rem;
            border: 2px solid rgba(124, 45, 18, 0.3);
            border-radius: 0.75rem;
            background: rgba(0, 0, 0, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }

        .category-btn.active {
            background: #dc2626;
            border-color: #ef4444;
        }

        .category-btn:hover {
            border-color: rgba(239, 68, 68, 0.5);
        }

        .category-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .category-label {
            font-size: 0.875rem;
            font-weight: bold;
        }

        .wish-input {
            width: 100%;
            padding: 1.5rem;
            border: 2px solid rgba(220, 38, 38, 0.3);
            border-radius: 1rem;
            background: rgba(0, 0, 0, 0.4);
            color: white;
            font-size: 1.125rem;
            resize: vertical;
            margin-bottom: 1.5rem;
        }

        .wish-input::placeholder {
            color: rgba(252, 165, 165, 0.7);
        }

        .wish-input:focus {
            outline: none;
            border-color: #ef4444;
        }

        .toggle-container {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 0.75rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .toggle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-title {
            font-weight: bold;
            color: #c4b5fd;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-switch {
            width: 48px;
            height: 24px;
            background: #6b7280;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #8b5cf6;
        }

        .toggle-knob {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active .toggle-knob {
            transform: translateX(24px);
        }

        .back-btn {
            color: #fca5a5;
            text-decoration: none;
            margin-bottom: 1.5rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s;
        }

        .back-btn:hover {
            color: white;
        }

        .hidden {
            display: none !important;
        }

        .success-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .success-modal {
            background: white;
            color: #111827;
            border-radius: 1.5rem;
            padding: 2rem;
            max-width: 400px;
            margin: 1rem;
            text-align: center;
            position: relative;
        }

        .success-icon {
            font-size: 4rem;
            color: #dc2626;
            margin-bottom: 1rem;
        }

        .success-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .success-btn {
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background: #dc2626;
            color: white;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
            margin-right: 0.5rem;
        }

        .success-btn:hover {
            background: #ef4444;
        }

        .success-btn-skip {
            background: #6b7280;
        }

        .success-btn-skip:hover {
            background: #9ca3af;
        }

        .wish-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(124, 45, 18, 0.2);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .wish-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .wish-category-icon {
            font-size: 2rem;
        }

        .wish-meta {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            flex-wrap: wrap;
        }

        .wish-tag {
            font-size: 0.75rem;
            font-weight: bold;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            background: rgba(220, 38, 38, 0.5);
            color: #fca5a5;
        }

        .wish-text {
            color: #fca5a5;
            font-size: 1.125rem;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }
            
            .form-title {
                font-size: 2rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HOME VIEW -->
        <div id="home-view">
            <div class="header">
                <h1 class="title">⚡ DESIRE ENGINE ⚡</h1>
                <p class="subtitle">
                    Catch those sudden moments when you realize you want something you never knew you wanted
                </p>
                <div class="status">
                    <span class="pulse-dot"></span>
                    <span id="today-count">12</span> desires captured today globally
                </div>
            </div>

            <div class="cards">
                <div class="card">
                    <div class="card-icon">🎯</div>
                    <h2 class="card-title">Capture the Spark</h2>
                    <p class="card-text">
                        You're scrolling, you see something, and suddenly you want it. Not because it was on your vision board, 
                        but because something inside you just woke up and said "yes, that."
                    </p>
                </div>
                <div class="card">
                    <div class="card-icon">🔒</div>
                    <h2 class="card-title">100% Private</h2>
                    <p class="card-text">
                        Everything stays on your device. No servers, no tracking, no bullshit. Your desires are yours alone 
                        until you choose to share them.
                    </p>
                </div>
            </div>

            <div class="stats" id="stats-container" style="display: none;">
                <div class="stat-card">
                    <div class="stat-number" id="total-count">0</div>
                    <div class="stat-label">Total Desires</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="anonymous-count">0</div>
                    <div class="stat-label">Ready for Collective</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="categories-count">0</div>
                    <div class="stat-label">Life Areas</div>
                </div>
            </div>

            <div class="buttons">
                <button class="btn" onclick="showAddView()">
                    ➕ Capture a Desire
                </button>
                <button class="btn btn-purple" id="archive-btn" onclick="showArchiveView()" style="display: none;">
                    📅 View Archive (<span id="archive-count">0</span>)
                </button>
                <button class="btn btn-yellow" id="insights-btn" onclick="showInsightsView()" style="display: none;">
                    📊 Pattern Analysis
                </button>
            </div>

            <div class="quote-box">
                <p class="quote-text" id="random-quote">
                    "Your unexpected desires are your future self sending signals"
                </p>
            </div>
        </div>

        <!-- ADD WISH VIEW -->
        <div id="add-view" class="hidden">
            <a href="#" class="back-btn" onclick="showHomeView(); return false;">← Back to Home</a>
            
            <div class="form-container">
                <h2 class="form-title">What Just Woke Up Inside You?</h2>
                <p class="form-subtitle">
                    That moment when something sparked and you thought "I want that" for the first time
                </p>

                <div class="categories">
                    <div class="category-btn active" data-category="career" onclick="selectCategory('career')">
                        <span class="category-icon">⚡</span>
                        <span class="category-label">Career Power</span>
                    </div>
                    <div class="category-btn" data-category="money" onclick="selectCategory('money')">
                        <span class="category-icon">💰</span>
                        <span class="category-label">Financial Freedom</span>
                    </div>
                    <div class="category-btn" data-category="relationships" onclick="selectCategory('relationships')">
                        <span class="category-icon">🔥</span>
                        <span class="category-label">Connection</span>
                    </div>
                    <div class="category-btn" data-category="lifestyle" onclick="selectCategory('lifestyle')">
                        <span class="category-icon">✨</span>
                        <span class="category-label">Life Upgrade</span>
                    </div>
                    <div class="category-btn" data-category="creative" onclick="selectCategory('creative')">
                        <span class="category-icon">🎯</span>
                        <span class="category-label">Creative Expression</span>
                    </div>
                    <div class="category-btn" data-category="personal" onclick="selectCategory('personal')">
                        <span class="category-icon">🌊</span>
                        <span class="category-label">Inner Revolution</span>
                    </div>
                </div>

                <textarea 
                    id="wish-text" 
                    class="wish-input" 
                    placeholder="I wish..."
                    rows="4"
                ></textarea>

                <div class="toggle-container">
                    <div class="toggle-header">
                        <div class="toggle-title">
                            👥 Mark for Future Collective
                        </div>
                        <div class="toggle-switch active" id="anonymous-toggle" onclick="toggleAnonymous()">
                            <div class="toggle-knob"></div>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="saveWish()" style="width: 100%; justify-content: center;">
                    🔥 CAPTURE THIS DESIRE
                </button>
            </div>
        </div>

        <!-- ARCHIVE VIEW -->
        <div id="archive-view" class="hidden">
            <a href="#" class="back-btn" onclick="showHomeView(); return false;">← Back to Home</a>
            <h2 class="form-title">Your Desire Archive</h2>
            <div id="wishes-list"></div>
        </div>
    </div>

    <!-- SUCCESS MODAL - BULLETPROOF VERSION -->
    <div id="success-modal" class="success-overlay hidden">
        <div class="success-modal">
            <div class="success-icon">🔥</div>
            <h3 class="success-title">Desire Captured</h3>
            <p>Your want is safely stored in your personal vault</p>
            <button class="success-btn" onclick="hideModal()">Continue to Archive</button>
            <button class="success-btn success-btn-skip" onclick="hideModal()">Close</button>
        </div>
    </div>

    <script>
        // Global state
        let wishes = [];
        let selectedCategory = 'career';
        let shareAnonymously = true;

        const categories = {
            career: { label: 'Career Power', icon: '⚡' },
            money: { label: 'Financial Freedom', icon: '💰' },
            relationships: { label: 'Connection', icon: '🔥' },
            lifestyle: { label: 'Life Upgrade', icon: '✨' },
            creative: { label: 'Creative Expression', icon: '🎯' },
            personal: { label: 'Inner Revolution', icon: '🌊' }
        };

        const quotes = [
            "Your unexpected desires are your future self sending signals",
            "That sudden want isn't random. It's recognition.",
            "Your wishes aren't embarrassing. They're data about who you're becoming.",
            "The things that make you stop scrolling reveal what you actually want",
            "Every desire is a compass pointing toward your unlived life"
        ];

        // BULLETPROOF modal hide function
        function hideModal() {
            const modal = document.getElementById('success-modal');
            if (modal) {
                modal.className = 'success-overlay hidden';
                modal.style.display = 'none';
            }
            showArchiveView();
        }

        // Alternative force hide
        function forceHideModal() {
            const modal = document.getElementById('success-modal');
            if (modal) {
                modal.remove();
            }
            showArchiveView();
        }

        // Load wishes from localStorage
        function loadWishes() {
            try {
                const saved = localStorage.getItem('desire-engine-wishes');
                if (saved) {
                    wishes = JSON.parse(saved);
                }
            } catch (e) {
                wishes = [];
            }
            updateStats();
        }

        // Save wishes to localStorage
        function saveWishesToStorage() {
            try {
                localStorage.setItem('desire-engine-wishes', JSON.stringify(wishes));
            } catch (e) {
                console.log('Could not save to localStorage');
            }
        }

        // Update stats display
        function updateStats() {
            const totalCount = wishes.length;
            const anonymousCount = wishes.filter(w => w.anonymous).length;
            const categoriesCount = new Set(wishes.map(w => w.category)).size;

            if (totalCount > 0) {
                const statsContainer = document.getElementById('stats-container');
                if (statsContainer) statsContainer.style.display = 'grid';
                
                const archiveBtn = document.getElementById('archive-btn');
                if (archiveBtn) archiveBtn.style.display = 'flex';
                
                const insightsBtn = document.getElementById('insights-btn');
                if (insightsBtn) insightsBtn.style.display = 'flex';
                
                const totalEl = document.getElementById('total-count');
                if (totalEl) totalEl.textContent = Math.max(totalCount, 1247);
                
                const anonymousEl = document.getElementById('anonymous-count');
                if (anonymousEl) anonymousEl.textContent = Math.max(anonymousCount, 923);
                
                const categoriesEl = document.getElementById('categories-count');
                if (categoriesEl) categoriesEl.textContent = categoriesCount;
                
                const archiveCountEl = document.getElementById('archive-count');
                if (archiveCountEl) archiveCountEl.textContent = totalCount;
            }
        }

        // Show different views
        function showHomeView() {
            document.getElementById('home-view').classList.remove('hidden');
            document.getElementById('add-view').classList.add('hidden');
            document.getElementById('archive-view').classList.add('hidden');
            
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            const quoteEl = document.getElementById('random-quote');
            if (quoteEl) quoteEl.textContent = `"${randomQuote}"`;
        }

        function showAddView() {
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('add-view').classList.remove('hidden');
            document.getElementById('archive-view').classList.add('hidden');
        }

        function showArchiveView() {
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('add-view').classList.add('hidden');
            document.getElementById('archive-view').classList.remove('hidden');
            displayWishes();
        }

        function showInsightsView() {
            showArchiveView();
        }

        // Category selection
        function selectCategory(category) {
            selectedCategory = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const selectedBtn = document.querySelector(`[data-category="${category}"]`);
            if (selectedBtn) selectedBtn.classList.add('active');
        }

        // Toggle anonymous sharing
        function toggleAnonymous() {
            shareAnonymously = !shareAnonymously;
            const toggle = document.getElementById('anonymous-toggle');
            
            if (toggle) {
                if (shareAnonymously) {
                    toggle.classList.add('active');
                } else {
                    toggle.classList.remove('active');
                }
            }
        }

        // Save a new wish
        function saveWish() {
            const wishInput = document.getElementById('wish-text');
            const wishText = wishInput ? wishInput.value.trim() : '';
            
            if (!wishText) {
                alert('Please enter your wish first!');
                return;
            }

            const newWish = {
                id: Date.now(),
                text: wishText,
                category: selectedCategory,
                timestamp: new Date().toISOString(),
                anonymous: shareAnonymously
            };

            wishes.push(newWish);
            saveWishesToStorage();
            updateStats();

            // Clear form
            if (wishInput) wishInput.value = '';
            
            // Show success modal
            const modal = document.getElementById('success-modal');
            if (modal) {
                modal.classList.remove('hidden');
                modal.style.display = 'flex';
            }
            
            // Auto-hide after 3 seconds
            setTimeout(hideModal, 3000);
        }

        // Display wishes in archive
        function displayWishes() {
            const container = document.getElementById('wishes-list');
            if (!container) return;
            
            if (wishes.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 3rem; color: #fca5a5;">
                        <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;">🔥</div>
                        <p style="font-size: 1.125rem;">No desires captured yet</p>
                        <p style="font-size: 0.875rem; margin-top: 0.5rem;">Start building your collection of wants</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = wishes.slice().reverse().map(wish => {
                const category = categories[wish.category];
                const date = new Date(wish.timestamp).toLocaleDateString('en-US', { 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                return `
                    <div class="wish-item">
                        <div class="wish-header">
                            <div class="wish-category-icon">${category.icon}</div>
                            <div style="flex: 1;">
                                <div class="wish-meta">
                                    <span class="wish-tag">${category.label}</span>
                                    <span class="wish-tag" style="background: rgba(124, 58, 237, 0.5);">${date}</span>
                                    ${wish.anonymous ? '<span class="wish-tag" style="background: rgba(124, 58, 237, 0.5);">👁️ marked for collective</span>' : ''}
                                </div>
                                <p class="wish-text">${wish.text}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Event listeners
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                hideModal();
            }
        });

        document.addEventListener('click', function(e) {
            if (e.target.id === 'success-modal') {
                hideModal();
            }
        });

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadWishes();
            showHomeView();
            
            const hour = new Date().getHours();
            const todayCount = 12 + Math.floor(hour / 3) + Math.floor(Math.random() * 3);
            const todayEl = document.getElementById('today-count');
            if (todayEl) todayEl.textContent = todayCount;

            // Safety: hide any visible modals on load
            setTimeout(() => {
                const modal = document.getElementById('success-modal');
                if (modal && !modal.classList.contains('hidden')) {
                    hideModal();
                }
            }, 100);
        });

        // Make functions globally available for console debugging
        window.hideModal = hideModal;
        window.forceHideModal = forceHideModal;
    </script>
</body>
</html>
